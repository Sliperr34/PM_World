[
  {
    "type": "mutation",
    "id": "CHAIN_ARTS",
    "name": "Chain Arts",
    "points": 0,
    "description": "",
    "starting_trait": false,
    "purifiable": false,
    "valid": false
  },
  {
    "id": "ca_chain_flurry",
    "type": "SPELL",
    "name": { "str": "Chain Flurry" },
    "description": "Strike with the chain in an arc, possibly knocking enemies off balance.",
    "flags": [ "RANDOM_DAMAGE", "SILENT", "NON_MAGICAL", "NO_FAIL", "NO_HANDS" ],
    "valid_targets": [ "hostile", "ground" ],
    "magic_type": "PM_MARTIAL_ARTS",
    "spell_class": "CHAIN_ARTS",
    "base_energy_cost": 10, 
    "max_level": 1,
    "min_damage": { "math": [ "u_weapon_damage * 0.4 * (0.5 + (0.1 * u_skill('melee')))" ] },
    "max_damage": { "math": [ "u_weapon_damage * 0.6 * (0.5 + (0.1 * u_skill('melee')))" ] },
    "min_range": 2,
    "max_range": 2,
    "min_aoe": 60,
    "max_aoe": 60,
    "base_casting_time": 80,
    "damage_type": "bash",
    "effect": "effect_on_condition",
    "effect_str": "EOC_CHAIN_KNOCKDOWN",
    "shape": "cone",
    "condition": { "u_has_wielded_with_weapon_category": "WHIPS" },
    "condition_fail_message": "You must have a chain equipped."
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CHAIN_KNOCKDOWN",
    "effect": [
      {
        "if": { "math": [ "10 <= rand(10 + u_skill('melee'))" ] },
        "then": { "u_add_effect": "downed", "duration": "4 seconds" },
        "else": { "u_add_effect": "dazed", "duration": "4 seconds" }
      }
    ]
  },
  {
    "id": "ca_chain_crush",
    "type": "SPELL",
    "name": { "str": "Chain Crush" },
    "description": "Slam a chain down on an already prone opponent for heavy damage.",
    "flags": [ "RANDOM_DAMAGE", "SILENT", "NON_MAGICAL", "NO_FAIL", "NO_HANDS" ],
    "valid_targets": [ "hostile" ],
    "magic_type": "PM_MARTIAL_ARTS",
    "spell_class": "CHAIN_ARTS",
    "base_energy_cost": 10, 
    "max_level": 1,
    "min_damage": { "math": [ "u_weapon_damage * 2.0 * (0.5 + (0.1 * u_skill('melee')))" ] },
    "max_damage": { "math": [ "u_weapon_damage * 3.0 * (0.5 + (0.1 * u_skill('melee')))" ] },
    "min_range": 2,
    "max_range": 2,
    "min_aoe": 0,
    "max_aoe": 0,
    "base_casting_time": 80,
    "damage_type": "bash",
    "effect": "attack",
    "shape": "blast",
    "condition": { "and": [ { "u_has_wielded_with_weapon_category": "WHIPS" }, { "npc_has_effect": "downed" } ] },
    "condition_fail_message": "You must have a chain equipped, and the opponent must be downed."
  },
  {
    "id": "ca_chain_curl",
    "type": "SPELL",
    "name": { "str": "Chain Curl" },
    "description": "Wrap an opponent in a chain, and then toss them away.",
    "flags": [ "NO_EXPLOSION_SFX", "SILENT", "NON_MAGICAL", "NO_FAIL", "NO_HANDS" ],
    "valid_targets": [ "hostile" ],
    "magic_type": "PM_MARTIAL_ARTS",
    "spell_class": "CHAIN_ARTS",
    "base_energy_cost": 20, 
    "max_level": 1,
    "min_damage": -3,
    "max_damage": -3,
    "min_range": 3,
    "max_range": 3,
    "min_aoe": 0,
    "max_aoe": 0,
    "base_casting_time": 80,
    "shape": "blast",
    "condition": { "u_has_wielded_with_weapon_category": "WHIPS" },
    "effect": "effect_on_condition",
    "effect_str": "EOC_CHAIN_CURL"
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CHAIN_CURL",
    "effect": [
      { "u_location_variable": { "context_val": "loc" } },
      { "npc_cast_spell": { "id": "chain_curl_1" }, "loc": { "context_val": "loc" } },
      { "u_location_variable": { "context_val": "loc" } },
      { "npc_cast_spell": { "id": "chain_curl_2" }, "loc": { "context_val": "loc" } },
      { "u_location_variable": { "context_val": "loc" } },
      { "npc_cast_spell": { "id": "chain_curl_3" }, "loc": { "context_val": "loc" } }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_CHAIN_CURL_FINAL",
    "effect": [
      { "u_location_variable": { "context_val": "loc" } },
      { "npc_cast_spell": { "id": "chain_curl_1" }, "loc": { "context_val": "loc" } },
      { "u_location_variable": { "context_val": "loc" } },
      { "npc_cast_spell": { "id": "chain_curl_2" }, "loc": { "context_val": "loc" } },
      { "u_location_variable": { "context_val": "loc" } },
      { "npc_cast_spell": { "id": "chain_curl_3" }, "loc": { "context_val": "loc" } }
    ]
  },
  {
    "id": "chain_curl_1",
    "type": "SPELL",
    "name": { "str": "Chain Curl" },
    "description": "Wrap an opponent in a chain, and then toss them away.",
    "flags": [ "SILENT", "NON_MAGICAL", "NO_FAIL", "NO_HANDS" ],
    "valid_targets": [ "hostile" ],
    "max_level": 1,
    "min_damage": -3,
    "max_damage": -3,
    "min_range": 3,
    "max_range": 3,
    "min_aoe": 0,
    "max_aoe": 0,
    "base_casting_time": 10,
    "shape": "blast",
    "effect": "directed_push"
  },
  {
    "id": "chain_curl_2",
    "type": "SPELL",
    "name": { "str": "Chain Curl" },
    "description": "Wrap an opponent in a chain, and then toss them away.",
    "flags": [ "SILENT", "NON_MAGICAL", "RANDOM_DAMAGE", "NO_FAIL", "NO_HANDS" ],
    "valid_targets": [ "hostile" ],
    "max_level": 1,
    "min_damage": { "math": [ "u_weapon_damage * 0.5" ] },
    "max_damage": { "math": [ "u_weapon_damage * 1.2" ] },
    "min_range": 3,
    "max_range": 3,
    "min_aoe": 1,
    "max_aoe": 1,
    "damage_type": "cut",
    "base_casting_time": 10,
    "shape": "blast",
    "effect": "attack"
  },
  {
    "id": "chain_curl_3",
    "type": "SPELL",
    "name": { "str": "Chain Curl" },
    "description": "Wrap an opponent in a chain, and then toss them away.",
    "flags": [ "SILENT", "NON_MAGICAL", "RANDOM_DAMAGE", "NO_FAIL", "NO_HANDS" ],
    "valid_targets": [ "hostile" ],
    "max_level": 1,
    "min_damage": 5,
    "max_damage": 10,
    "min_range": 3,
    "max_range": 3,
    "min_aoe": 0,
    "max_aoe": 0,
    "base_casting_time": 1,
    "shape": "blast",
    "effect": "directed_push"
  }
]